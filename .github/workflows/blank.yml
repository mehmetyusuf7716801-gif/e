-- MM2 UNDERGROUND AUTO-FARM
-- Settings: Speed 25, Underground Mode, Full English Logic

local Player = game.Players.LocalPlayer
local RunService = game:GetService("RunService")
local WALK_SPEED = 25
local DEPTH_OFFSET = 6

print("Initializing English Script...")

-- Function to find the nearest coin
local function findNearestCoin()
    local character = Player.Character
    local rootPart = character and character:FindFirstChild("HumanoidRootPart")
    if not rootPart then return nil end

    local nearestTarget = nil
    local minDistance = math.huge
    local coinContainer = workspace:FindFirstChild("Normal") and workspace.Normal:FindFirstChild("CoinContainer")

    if coinContainer then
        for _, coin in pairs(coinContainer:GetChildren()) do
            if coin:IsA("BasePart") then
                local distance = (rootPart.Position - coin.Position).Magnitude
                if distance < minDistance then
                    minDistance = distance
                    nearestTarget = coin
                end
            end
        end
    end
    return nearestTarget
end

-- Core Loop for Movement and Noclip
RunService.Stepped:Connect(function()
    local character = Player.Character
    if character then
        -- Enable Noclip to move through the floor
        for _, part in pairs(character:GetChildren()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end

        local root = character:FindFirstChild("HumanoidRootPart")
        local humanoid = character:FindFirstChild("Humanoid")
        local targetCoin = findNearestCoin()

        if root and humanoid and targetCoin then
            humanoid.WalkSpeed = WALK_SPEED
            local targetPosition = targetCoin.Position - Vector3.new(0, DEPTH_OFFSET, 0)
            
            -- Keep character at fixed underground depth
            root.CFrame = CFrame.new(root.Position.X, targetPosition.Y, root.Position.Z)
            
            -- Move toward the target coin
            humanoid:MoveTo(targetPosition)
        end
    end
end)

-- Status Notification
game.StarterGui:SetCore("SendNotification", {
    Title = "FARM ACTIVE",
    Text = "Speed: 25 | Mode: Underground",
    Duration = 5
})
